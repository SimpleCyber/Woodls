<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: transparent;
        user-select: none;
        -webkit-app-region: no-drag;
      }
      /* Hide scrollbar */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
    </style>
  </head>
  <body
    class="flex items-center justify-center h-screen w-screen bg-transparent p-2"
  >
    <!-- Toast Container -->
    <div
      class="bg-[#181818] w-full h-full rounded-2xl border border-white/10 shadow-2xl flex flex-col p-4 relative"
    >
      <!-- Close Button -->
      <!-- Only visible if user wants to dismiss without copying, but copy closes it anyway -->
      <div
        id="close-btn"
        class="absolute top-3 right-3 text-white/40 hover:text-white cursor-pointer transition-colors"
      >
        <i class="fa-solid fa-xmark text-sm"></i>
      </div>

      <!-- Header -->
      <div class="flex items-center gap-2 mb-2">
        <div
          class="w-5 h-5 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 text-xs"
        >
          <i class="fa-solid fa-info"></i>
        </div>
        <span class="text-white font-medium text-sm">Copy last transcript</span>
      </div>

      <!-- Text Preview -->
      <div class="flex-1 overflow-hidden relative mb-2">
        <p
          id="preview-text"
          class="text-white/70 text-sm leading-snug line-clamp-2"
        >
          <!-- Text inserted here -->
        </p>
        <!-- Fade at bottom -->
        <div
          class="absolute bottom-0 left-0 w-full h-4 bg-gradient-to-t from-[#181818] to-transparent"
        ></div>
      </div>

      <!-- Copy Button -->
      <div class="flex justify-center">
        <button
          id="copy-btn"
          class="bg-white/10 hover:bg-white hover:text-black text-white px-6 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 border border-white/5 active:scale-95"
        >
          Copy
        </button>
      </div>
    </div>

    <script>
      const { ipcRenderer } = require("electron");
      let textToCopy = "";

      // Close handler
      document.getElementById("close-btn").onclick = () => {
        ipcRenderer.send("hide-copy-popup");
      };

      ipcRenderer.on("set-text", (event, text) => {
        textToCopy = text;
        const previewEl = document.getElementById("preview-text");
        previewEl.innerText = text || "No text available";
        previewEl.title = text; // Tooltip for full text
      });

      document.getElementById("copy-btn").onclick = () => {
        if (textToCopy) {
          ipcRenderer.send("copy-text", textToCopy);
        }
      };
    </script>
  </body>
</html>
