<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      background: transparent;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      -webkit-app-region: ignore; /* Click through everything by default if needed, but we might want the icon visible */
    }
    /* We want the icon to be visible, so the actionable area is just the icon div */
    #mic-container {
      transition: transform 0.1s ease-out;
    }
  </style>
</head>
<body>
  <!-- Pill Container -->
  <div class="bg-black/90 backdrop-blur-md rounded-full px-5 py-3 flex items-center justify-center gap-1.5 shadow-2xl border border-white/10 transition-transform duration-100" id="pill">
     <!-- Waveform Bars -->
     <div class="bar w-1.5 bg-white rounded-full h-3 transition-all duration-75"></div>
     <div class="bar w-1.5 bg-white rounded-full h-5 transition-all duration-75"></div>
     <div class="bar w-1.5 bg-white rounded-full h-8 transition-all duration-75"></div>
     <div class="bar w-1.5 bg-white rounded-full h-5 transition-all duration-75"></div>
     <div class="bar w-1.5 bg-white rounded-full h-3 transition-all duration-75"></div>
  </div>

  <script>
    const { ipcRenderer } = require('electron');
    const bars = document.querySelectorAll('.bar');
    const pill = document.getElementById('pill');

    ipcRenderer.on('mic-volume', (event, volume) => {
      // volume is 0.0 - 1.0
      // Animate bars based on volume locally for smoothness
      
      const v = Math.max(volume, 0.1); // min visual
      
      // Update bars heights with some randomness for wave effect
      bars.forEach((bar, i) => {
          // Center bars (idx 2) get most amplitude
          const centerFactor = 1 - Math.abs(i - 2) * 0.2; 
          const h = 8 + (v * 40 * centerFactor * (0.8 + Math.random() * 0.4));
          bar.style.height = h + 'px';
      });

      // Subtle pulse of the pill (Disabled per feedback)
      // const scale = 1 + (v * 0.05);
      // pill.style.transform = `scale(${scale})`;
    });
  </script>
</body>
</html>
